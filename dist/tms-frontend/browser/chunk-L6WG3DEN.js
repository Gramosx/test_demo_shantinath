import{a as Z}from"./chunk-KQNJKAFO.js";import"./chunk-MS4AQ6UA.js";import{b as K,c as Q,d as W,e as X,f as Y}from"./chunk-25DKDMRL.js";import"./chunk-JWSJLOX5.js";import{a as R}from"./chunk-OVJ2KSUS.js";import"./chunk-Y4PFWTHH.js";import"./chunk-OHEZVM5U.js";import{a as U,b as N,g as P,i as T,k as u,n as G,o as V,r as D,t as j,v as B,w as A,x as k,y as L}from"./chunk-VTNE6TZS.js";import{a as $,d as z,k as H,l as J}from"./chunk-OXUIA66D.js";import"./chunk-CAXGTU4L.js";import{a as O}from"./chunk-46EYUD2W.js";import{$b as y,Da as s,Ha as l,Mb as b,Nb as I,Qa as a,Ra as r,Rb as w,Sa as d,Ya as S,Zb as x,ac as q,hb as m,jb as c,qa as n,ua as p,za as C}from"./chunk-K4VOPVC6.js";function re(i,t){i&1&&(a(0,"mat-error"),m(1," Username is required "),r())}function te(i,t){i&1&&(a(0,"mat-error"),m(1," Full name is required "),r())}function ie(i,t){i&1&&(a(0,"mat-error"),m(1," Email is required "),r())}function oe(i,t){i&1&&(a(0,"mat-error"),m(1," Please enter a valid email "),r())}function ae(i,t){if(i&1&&(a(0,"mat-option",16),m(1),r()),i&2){let o=t.$implicit;l("value",o),n(),c(" ",o," ")}}function me(i,t){i&1&&(a(0,"mat-error"),m(1," Role is required "),r())}function ne(i,t){i&1&&(a(0,"mat-error"),m(1," Password is required "),r())}function le(i,t){i&1&&(a(0,"mat-error"),m(1," Please confirm your password "),r())}function se(i,t){i&1&&(a(0,"mat-error"),m(1," Passwords do not match "),r())}var ee=class i{constructor(t,o,e,f){this.fb=t;this.userService=o;this.router=e;this.route=f;this.userForm=this.fb.group({username:["",u.required],fullName:["",u.required],email:["",[u.required,u.email]],role:["USER",u.required],password:["",this.isEditMode?[]:[u.required]],confirmPassword:["",this.isEditMode?[]:[u.required]]},{validators:this.passwordMatchValidator})}userForm;isEditMode=!1;userRoles=Object.values(O);ngOnInit(){let t=this.route.snapshot.paramMap.get("id");this.isEditMode=!!t,this.isEditMode&&t&&this.userService.getUser(t).subscribe({next:o=>{o?this.userForm.patchValue({username:o.username,fullName:o.fullName,email:o.email,role:o.role}):this.router.navigate(["/users"])},error:o=>{console.error("Error loading user:",o),this.router.navigate(["/users"])}})}passwordMatchValidator(t){let o=t.get("password"),e=t.get("confirmPassword");o?.value!==e?.value?e?.setErrors({passwordMismatch:!0}):e?.setErrors(null)}onSubmit(){if(this.userForm.invalid)return;let t={username:this.userForm.value.username,fullName:this.userForm.value.fullName,email:this.userForm.value.email,role:this.userForm.value.role},o=this.route.snapshot.paramMap.get("id");this.isEditMode&&o?this.userService.updateUser(o,t).subscribe({next:e=>{e&&this.router.navigate(["/users"])},error:e=>{console.error("Error updating user:",e)}}):this.userService.createUser(t).subscribe({next:e=>{this.router.navigate(["/users"])},error:e=>{console.error("Error creating user:",e)}})}static \u0275fac=function(o){return new(o||i)(p(k),p(Z),p(y),p(x))};static \u0275cmp=C({type:i,selectors:[["app-user-form"]],decls:46,vars:15,consts:[[1,"user-form-container"],[1,"page-title"],[3,"ngSubmit","formGroup"],[1,"form-row"],["appearance","fill",1,"form-field"],["matInput","","formControlName","username","required",""],[4,"ngIf"],["matInput","","formControlName","fullName","required",""],["matInput","","formControlName","email","required","","type","email"],["formControlName","role","required",""],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","password","type","password",3,"required"],["matInput","","formControlName","confirmPassword","type","password",3,"required"],[1,"button-row"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-stroked-button","","type","button","routerLink","/users"],[3,"value"]],template:function(o,e){if(o&1&&(a(0,"div",0)(1,"h1",1),m(2),r(),a(3,"mat-card")(4,"form",2),S("ngSubmit",function(){return e.onSubmit()}),a(5,"div",3)(6,"mat-form-field",4)(7,"mat-label"),m(8,"Username"),r(),d(9,"input",5),s(10,re,2,0,"mat-error",6),r(),a(11,"mat-form-field",4)(12,"mat-label"),m(13,"Full Name"),r(),d(14,"input",7),s(15,te,2,0,"mat-error",6),r()(),a(16,"div",3)(17,"mat-form-field",4)(18,"mat-label"),m(19,"Email"),r(),d(20,"input",8),s(21,ie,2,0,"mat-error",6)(22,oe,2,0,"mat-error",6),r(),a(23,"mat-form-field",4)(24,"mat-label"),m(25,"Role"),r(),a(26,"mat-select",9),s(27,ae,2,2,"mat-option",10),r(),s(28,me,2,0,"mat-error",6),r()(),a(29,"div",3)(30,"mat-form-field",4)(31,"mat-label"),m(32,"Password"),r(),d(33,"input",11),s(34,ne,2,0,"mat-error",6),r(),a(35,"mat-form-field",4)(36,"mat-label"),m(37,"Confirm Password"),r(),d(38,"input",12),s(39,le,2,0,"mat-error",6)(40,se,2,0,"mat-error",6),r()(),a(41,"div",13)(42,"button",14),m(43),r(),a(44,"button",15),m(45,"Cancel"),r()()()()()),o&2){let f,v,_,g,E,F,M,h;n(2),c("",e.isEditMode?"Edit":"Create"," User"),n(2),l("formGroup",e.userForm),n(6),l("ngIf",(f=e.userForm.get("username"))==null?null:f.hasError("required")),n(5),l("ngIf",(v=e.userForm.get("fullName"))==null?null:v.hasError("required")),n(6),l("ngIf",(_=e.userForm.get("email"))==null?null:_.hasError("required")),n(),l("ngIf",(g=e.userForm.get("email"))==null?null:g.hasError("email")),n(5),l("ngForOf",e.userRoles),n(),l("ngIf",(E=e.userForm.get("role"))==null?null:E.hasError("required")),n(5),l("required",!e.isEditMode),n(),l("ngIf",(F=e.userForm.get("password"))==null?null:F.hasError("required")),n(4),l("required",!e.isEditMode),n(),l("ngIf",(M=e.userForm.get("confirmPassword"))==null?null:M.hasError("required")),n(),l("ngIf",(h=e.userForm.get("confirmPassword"))==null?null:h.hasError("passwordMismatch")),n(2),l("disabled",e.userForm.invalid),n(),c(" ",e.isEditMode?"Update":"Create"," ")}},dependencies:[w,b,I,L,D,T,G,V,A,j,B,J,H,z,$,R,P,U,N,Q,K,Y,X,W,q],styles:[".user-form-container[_ngcontent-%COMP%]{padding:20px}.page-title[_ngcontent-%COMP%]{margin-bottom:20px}.form-row[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:20px}.form-field[_ngcontent-%COMP%]{flex:1}.button-row[_ngcontent-%COMP%]{display:flex;gap:10px;margin-top:20px}"]})};export{ee as UserFormComponent};
