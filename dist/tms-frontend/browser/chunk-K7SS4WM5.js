import{a as D}from"./chunk-YCMZOG5D.js";import{M as T,P as g,Vb as p,a as d,b as u,l as o}from"./chunk-K4VOPVC6.js";var l=class{static addBusinessDays(e,t,r=[]){let n=new Date(e),a=0;for(;a<t;)n.setDate(n.getDate()+1),this.isBusinessDay(n,r)&&a++;return n}static isBusinessDay(e,t=[]){let r=e.getDay();return r===0||r===6?!1:!t.some(n=>n.getFullYear()===e.getFullYear()&&n.getMonth()===e.getMonth()&&n.getDate()===e.getDate())}static calculateTenderDates(e,t=[]){let r=this.addBusinessDays(e,3,t),n=this.addBusinessDays(e,5,t),a=this.addBusinessDays(e,10,t),s=this.addBusinessDays(e,15,t),c=this.addBusinessDays(s,2,t);return{creation:e,sendForQuote:r,priceDiscussion:n,quoteApproval:a,submission:s,reference:c}}static formatDate(e){return e.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}};var m=class i{constructor(e){this.http=e}apiUrl=`${D.apiUrl}/tenders`;STORAGE_KEY="tenders";getTendersFromStorage(){let e=localStorage.getItem(this.STORAGE_KEY);return e?JSON.parse(e):[]}saveTendersToStorage(e){localStorage.setItem(this.STORAGE_KEY,JSON.stringify(e))}getTenders(){let e=this.getTendersFromStorage();return o({data:e,total:e.length})}getTender(e){let r=this.getTendersFromStorage().find(n=>n._id===e);return o(r||null)}createTender(e){let t=this.getTendersFromStorage(),r=u(d({},e),{_id:`tender_${Date.now()}`,tenderId:`TMS-${new Date().getFullYear()}-${String(t.length+1).padStart(3,"0")}`,createdAt:new Date,updatedAt:new Date,isDeleted:!1,createdBy:"user123"});return t.push(r),this.saveTendersToStorage(t),o(r)}updateTender(e,t){let r=this.getTendersFromStorage(),n=r.findIndex(S=>S._id===e);if(n===-1)return o(null);let a=r[n],s=t.dates?d(d({},a.dates),t.dates):a.dates,c=u(d(d({},a),t),{dates:s,updatedAt:new Date});return r[n]=c,this.saveTendersToStorage(r),o(c)}deleteTender(e){let t=this.getTendersFromStorage(),r=t.findIndex(n=>n._id===e);return r===-1?o(!1):(t[r]=u(d({},t[r]),{isDeleted:!0,deletionDate:new Date}),this.saveTendersToStorage(t),o(!0))}initializeDemoData(){let e=[{_id:"tender_1",tenderId:"TMS-2024-001",title:"Office Supplies Tender",description:"Annual procurement of office supplies",status:"IN_PROGRESS",country:"IN",organizationId:"org123",organizationUnit:"HQ",type:"GEM",items:["Paper","Pens","Notebooks"],toc:"CLEAR",currentStage:"PRICE_DISCUSSION",dates:l.calculateTenderDates(new Date),createdBy:"user123",createdAt:new Date,updatedAt:new Date,isDeleted:!1}];this.saveTendersToStorage(e)}getTenderStats(){let e=this.getTendersFromStorage(),t=e.filter(s=>!s.isDeleted&&s.status==="IN_PROGRESS"),r=e.filter(s=>!s.isDeleted&&s.status==="COMPLETED");return o({total:e.length,active:t.length,completed:r.length,growth:15,newOrganizations:3})}static \u0275fac=function(t){return new(t||i)(g(p))};static \u0275prov=T({token:i,factory:i.\u0275fac,providedIn:"root"})};export{l as a,m as b};
