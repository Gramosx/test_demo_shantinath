import{a as f}from"./chunk-YCMZOG5D.js";import{$b as h,M as m,P as p,Q as a,Vb as U,h as c,l as s,m as l,o as n,y as u}from"./chunk-K4VOPVC6.js";var i=class o{constructor(t){this.http=t;let e=localStorage.getItem(this.USER_KEY);e&&this.currentUserSubject.next(JSON.parse(e))}apiUrl=`${f.apiUrl}/auth`;currentUserSubject=new c(null);currentUser$=this.currentUserSubject.asObservable();TOKEN_KEY="auth_token";USER_KEY="current_user";isAuthenticated$=this.currentUser$.pipe(n(t=>!!t));login(t,e){let r={id:"1",username:"demo",email:t,fullName:"Demo User",role:"ADMIN",isActive:!0,createdAt:new Date,updatedAt:new Date};return localStorage.setItem(this.TOKEN_KEY,"mock-jwt-token"),localStorage.setItem(this.USER_KEY,JSON.stringify(r)),this.currentUserSubject.next(r),s(r)}register(t){let e={id:"2",username:t.username,email:t.email,fullName:t.fullName,role:"USER",isActive:!0,createdAt:new Date,updatedAt:new Date},r={user:e,access_token:"mock-jwt-token"};return localStorage.setItem(this.TOKEN_KEY,r.access_token),localStorage.setItem(this.USER_KEY,JSON.stringify(e)),this.currentUserSubject.next(e),s(r)}logout(){localStorage.removeItem(this.TOKEN_KEY),localStorage.removeItem(this.USER_KEY),this.currentUserSubject.next(null)}getProfile(){let t=localStorage.getItem(this.USER_KEY);if(t){let e=JSON.parse(t);return this.currentUserSubject.next(e),s(e)}return l(()=>new Error("No user found"))}getToken(){return localStorage.getItem(this.TOKEN_KEY)}isAuthenticated(){return!!localStorage.getItem(this.TOKEN_KEY)}static \u0275fac=function(e){return new(e||o)(p(U))};static \u0275prov=m({token:o,factory:o.\u0275fac,providedIn:"root"})};var x=o=>()=>{let t=a(i),e=a(h);return t.currentUser$.pipe(u(1),n(r=>r?o.includes(r.role)?!0:e.createUrlTree(["/dashboard"]):e.createUrlTree(["/auth/login"])))};export{i as a,x as b};
